-- Tabla de usuarios (opcional por ahora, puede usarse para autenticación futura)
CREATE TABLE G_Usuarios (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    nombre TEXT,
    email TEXT UNIQUE,
    creado_en TIMESTAMPTZ DEFAULT NOW()
);

-- Tabla de grupos
CREATE TABLE G_Grupos (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    nombre TEXT NOT NULL,
    descripcion TEXT,
    imagen_url TEXT,
    creador_id UUID REFERENCES G_Usuarios(id),
    fijo BOOLEAN DEFAULT FALSE,
    activo BOOLEAN DEFAULT TRUE,
    creado_en TIMESTAMPTZ DEFAULT NOW()
);

-- Tabla de módulos por grupo
CREATE TABLE G_Modulos (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    grupo_id UUID REFERENCES G_Grupos(id) ON DELETE CASCADE,
    nombre TEXT NOT NULL,
    orden INTEGER DEFAULT 0,
    activo BOOLEAN DEFAULT TRUE,
    creado_en TIMESTAMPTZ DEFAULT NOW()
);

-- Tabla de temas por módulo
CREATE TABLE G_Temas (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    modulo_id UUID REFERENCES G_Modulos(id) ON DELETE CASCADE,
    titulo TEXT NOT NULL,
    descripcion TEXT,
    video_youtube_url TEXT,
    video_supabase_url TEXT,
    imagen_url TEXT,
    orden INTEGER DEFAULT 0,
    creado_en TIMESTAMPTZ DEFAULT NOW()
);

-- Tabla de subtemas por tema
CREATE TABLE G_Subtemas (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tema_id UUID REFERENCES G_Temas(id) ON DELETE CASCADE,
    titulo TEXT NOT NULL,
    descripcion TEXT,
    video_youtube_url TEXT,
    video_supabase_url TEXT,
    imagen_url TEXT,
    orden INTEGER DEFAULT 0,
    creado_en TIMESTAMPTZ DEFAULT NOW()
);

-- Comentarios para temas
CREATE TABLE G_Comentarios_Temas (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tema_id UUID REFERENCES G_Temas(id) ON DELETE CASCADE,
    texto TEXT NOT NULL,
    creado_en TIMESTAMPTZ DEFAULT NOW()
);

-- Comentarios para subtemas
CREATE TABLE G_Comentarios_Subtemas (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    subtema_id UUID REFERENCES G_Subtemas(id) ON DELETE CASCADE,
    texto TEXT NOT NULL,
    creado_en TIMESTAMPTZ DEFAULT NOW()
);
